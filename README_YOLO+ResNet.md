# YOLO-Based Segmentation and ResNet Classification Pipeline

This repository contains the full workflow implemented in the notebook `YOLO+resnet.ipynb`, which combines YOLO-based parasite detection with a ResNet classifier for malaria parasite life-stage identification. The notebook performs detection, cropping, preprocessing, and classification, forming a complete two‑stage deep-learning pipeline.

---

## **Project Overview**
This notebook expands on the YOLO detection pipeline by adding a second-stage classifier. The workflow:
- Uses a pre-trained YOLO model to detect parasite regions from microscopy images.
- Crops individual parasite patches.
- Preprocesses these patches (resize, normalization, augmentation).
- Trains a ResNet classifier to categorize parasite life stages.
- Evaluates classifier performance using standard metrics.

This two-step approach leverages YOLO for localization and ResNet for fine-grained classification.

---

## **Notebook Summary: What the Code Does**

### **1. Load YOLO Detection Results**
The notebook begins by loading predicted bounding boxes generated by YOLO. These boxes represent detected parasite candidates.

### **2. Crop Detected Parasites**
For each bounding box:
- The corresponding region is cropped from the original image.
- Each crop is saved into class-specific folders or a unified dataset directory.
- Crops become the input dataset for the ResNet classifier.

### **3. Preprocessing for ResNet**
Each crop undergoes preprocessing:
- Resizing to model input dimensions (e.g., 224×224).
- Pixel normalization.
- Optional data augmentation (flip, rotate, color jitter, etc.).

### **4. Build and Train ResNet Model**
The notebook loads a ResNet architecture (e.g., ResNet-18 or ResNet-50):
- The final fully connected layer is replaced to match the number of malaria life stages.
- Training is performed on YOLO-cropped images.
- Validation and test sets are used to monitor performance.

### **5. Evaluate Classification Results**
Metrics computed include:
- Accuracy
- Precision
- Recall
- F1-score
- Confusion matrix

These results indicate how well the pipeline classifies parasite stages after YOLO segmentation.

---

## **Folder Structure**
```
project/
│── YOLO+resnet.ipynb
│── yolo_predictions/
│── cropped_images/
│── resnet_model/
│── metrics/
│── README.md
```

---

## **Requirements**
Install dependencies:
```
pip install ultralytics torch torchvision opencv-python-headless numpy pandas pillow scikit-learn matplotlib
```

---

## **How to Run the Notebook**
1. Open the notebook:
```
jupyter notebook YOLO+resnet.ipynb
```
2. Ensure YOLO predictions (bounding boxes) are available.
3. Run all cells in order:
   - Detection → Cropping → Preprocessing → ResNet training → Evaluation.
4. Final metrics and saved models will appear in the output folders.

---

## **Output**
The notebook produces:
- Cropped parasite image dataset
- Trained ResNet classifier
- Prediction results
- Summary metrics and plots

---

## **Notes**
- YOLO prediction quality directly influences ResNet performance.
- Training duration may vary based on available computational resources.
- Additional augmentation or deeper ResNet variants may improve accuracy.

